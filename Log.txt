*********************************************
Создание таблиц в оракл под своим конектом
---------------------------------------------
Таблица фактов

create table employers(emp_id int,emp_post_id int,emp_visor_id int,emp_name varchar(40),emp_phone varchar(40));

declare
  e_id   number;
  e_post_id   number;
  e_visor_id  number;
  e_name      varchar2(100);
  e_phone number;
begin
  e_id := 1;
  while e_id <=1000000 loop
    e_post_id := DBMS_RANDOM.VALUE(1,35);
	e_visor_id := DBMS_RANDOM.VALUE(1,10);
    e_name := DBMS_RANDOM.STRING('U',1)||DBMS_RANDOM.STRING('L', DBMS_RANDOM.VALUE(4,13));
	e_phone := DBMS_RANDOM.VALUE(89000000000,89999999999);
    insert into employers values(e_id,e_post_id,e_visor_id,e_name,round(e_phone));
    e_id := e_id + 1;	
  end loop;
  commit;
end;

Вес таблицы = 32.6 МБ
_____________________________________________

Таблица справочника_1

create table emp_post(post_id int,name varchar(50))

declare 
    p_id number;
    p_name varchar2(50);
    temp_id number;
begin
    select max(emp_post_id) into temp_id from employers;
    p_id := 1;
    while p_id<=temp_id loop
        p_name := DBMS_RANDOM.STRING('U',1)||DBMS_RANDOM.STRING('L', DBMS_RANDOM.VALUE(4,7));
        insert into emp_post values (p_id,p_name);
        p_id := p_id + 1;
    end loop;
    commit;
end;

Вес таблицы = 356 байт
_____________________________________________

Таблица справочника_2

create table emp_visor(visor_id int,name varchar(50));

declare 
    v_id number;
    v_name varchar2(50);
    temp_id number;
begin
    select max(emp_visor_id) into temp_id from employers;
    v_id := 1;
    while v_id<=temp_id loop
        v_name := DBMS_RANDOM.STRING('U',1)||DBMS_RANDOM.STRING('L', DBMS_RANDOM.VALUE(4,7));
        insert into emp_visor values (v_id,v_name);
        v_id := v_id + 1;
    end loop;
    commit;
end;

Вес таблицы = 95 байт
_____________________________________________

*********************************************
Импортируем таблицы в Hive с помощью sqoop
---------------------------------------------

Импорт таблицы фактов

sqoop import --connect jdbc:oracle:thin:@192.168.88.92:1521:orcl \
--username alex --password ******* \
--query "SELECT * FROM employers WHERE \$CONDITIONS" \
--target-dir /user/usertest/emp \
--hive-import --create-hive-table --hive-table "az.empployers" -m 1
_____________________________________________

Импорт таблицы справочника_1

sqoop import --connect jdbc:oracle:thin:@192.168.88.92:1521:orcl \
--username alex --password ******* \
--query "SELECT * FROM emp_post WHERE \$CONDITIONS" \
--target-dir /user/usertest/emp \
--hive-import --create-hive-table --hive-table "az.emp_post" -m 1
_____________________________________________

Импорт таблицы справочника_2

sqoop import --connect jdbc:oracle:thin:@192.168.88.92:1521:orcl \
--username alex --password ******* \
--query "SELECT * FROM emp_visor WHERE \$CONDITIONS" \
--target-dir /user/usertest/emp \
--hive-import --create-hive-table --hive-table "az.emp_visor" -m 1
_____________________________________________

*********************************************
Переводим таблицу фактов из текстового формата в ORC и PARQUET
---------------------------------------------
Перевод в ORC
CREATE TABLE employers_orc STORED AS ORC as select * from employers; 

Вес таблицы = 15.3 МБ
_____________________________________________
Перевод в PARQUET
create table employers_parquet stored as parquet as select * from employers;

Вес таблицы = 36 МБ
_____________________________________________
*********************************************

